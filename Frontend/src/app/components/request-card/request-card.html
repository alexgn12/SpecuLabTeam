<div class="card request-card m-2">
  <div class="card-header d-flex justify-content-between align-items-center">
    <span>Edificio ID: <strong>{{ building?.buildingCode }}</strong></span>
    <span
      class="badge"
      [ngClass]="{
        'bg-success': request.statusType === 'Aprobado',
        'bg-warning text-dark': request.statusType === 'Pendiente',
        'bg-danger': request.statusType === 'Rechazado',
        'bg-primary': request.statusType === 'Recibido'
      }"
    >
      {{ request.statusType }}
    </span>
  </div>

  <div class="card-body rc-grid">
    <!-- Columna izquierda: info -->
    <div class="rc-info">
      <h5 class="card-title mb-1">
        Nombre del Edificio:
        <span class="text-primary">{{ building?.buildingName || "N/A" }}</span>
      </h5>
      <p class="card-text mb-0">
        <strong>Direcci√≥n:</strong> {{ building?.street || "N/A" }}
      </p>

      <button class="btn btn-outline-info btn-sm mt-3"
              (click)="showDetails = !showDetails">Detalles</button>
    </div>

    <!-- Columna derecha: importes + total -->
    <div class="rc-nums">
      <ul class="list-group list-group-flush rc-list mb-2">
        <li class="list-group-item">
          <span class="rc-label">Building</span>
          <span class="rc-value">{{ request.buildingAmount }}</span>
        </li>
        <li class="list-group-item">
          <span class="rc-label">Maintenance</span>
          <span class="rc-value">{{ request.maintenanceAmount }}</span>
        </li>
      </ul>

      <div class="rc-total">
        <span>Total Amount</span>
        <strong>{{ totalAmountText }}</strong>
      </div>

      <!-- Acciones alineadas a la derecha -->
      <div class="rc-actions">
        <ng-container *ngIf="request.statusType === 'Pendiente'">
          <button class="btn btn-outline-success" (click)="aceptarRequest()">Aceptar</button>
          <button class="btn btn-outline-danger"  (click)="rechazarRequest()">Rechazar</button>
        </ng-container>

        <ng-container *ngIf="request.statusType === 'Recibido'">
          <a [routerLink]="['/formulario', building?.buildingCode, request.requestId]"
             class="btn btn-outline-warning">Solicitar Presupuesto</a>
          <button class="btn btn-outline-danger" (click)="rechazarRequest()">Rechazar</button>
        </ng-container>
      </div>
    </div>

    <!-- detalle (debajo del grid, ocupa todo el ancho) -->
    <div class="rc-detail" *ngIf="showDetails">
      <sl-detalle-request [request]="request" [building]="building"></sl-detalle-request>
    </div>
  </div>
</div>
